<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nunjucks 笔记 | peigenzi的博客</title>
    <meta name="description" content="记录生活，记录成长">
    
    
    <link rel="preload" href="/assets/css/styles.613d531f.css" as="style"><link rel="preload" href="/assets/js/app.613d531f.js" as="script"><link rel="preload" href="/assets/js/15.9a281c71.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.87b9e6fa.css"><link rel="prefetch" href="/assets/css/2.styles.a2bd3099.css"><link rel="prefetch" href="/assets/js/1.87b9e6fa.js"><link rel="prefetch" href="/assets/js/10.486bc3b5.js"><link rel="prefetch" href="/assets/js/11.2740aa39.js"><link rel="prefetch" href="/assets/js/12.dca4ad6e.js"><link rel="prefetch" href="/assets/js/13.e7f2eb25.js"><link rel="prefetch" href="/assets/js/14.9e7415ec.js"><link rel="prefetch" href="/assets/js/16.f9c3e05f.js"><link rel="prefetch" href="/assets/js/17.da4dd2f4.js"><link rel="prefetch" href="/assets/js/18.3ce14e87.js"><link rel="prefetch" href="/assets/js/19.9144fca1.js"><link rel="prefetch" href="/assets/js/2.a2bd3099.js"><link rel="prefetch" href="/assets/js/20.55456b64.js"><link rel="prefetch" href="/assets/js/21.eb87ce20.js"><link rel="prefetch" href="/assets/js/22.3032c894.js"><link rel="prefetch" href="/assets/js/23.68b362b8.js"><link rel="prefetch" href="/assets/js/24.05b6ca8d.js"><link rel="prefetch" href="/assets/js/25.72e5e4e2.js"><link rel="prefetch" href="/assets/js/26.210b553c.js"><link rel="prefetch" href="/assets/js/27.d4bfbf60.js"><link rel="prefetch" href="/assets/js/28.57bbe2af.js"><link rel="prefetch" href="/assets/js/29.e9bbb282.js"><link rel="prefetch" href="/assets/js/3.b179e001.js"><link rel="prefetch" href="/assets/js/30.22a571af.js"><link rel="prefetch" href="/assets/js/4.d90fa5e4.js"><link rel="prefetch" href="/assets/js/5.f96d621f.js"><link rel="prefetch" href="/assets/js/6.9779bc79.js"><link rel="prefetch" href="/assets/js/7.5c077e33.js"><link rel="prefetch" href="/assets/js/8.de0087fe.js"><link rel="prefetch" href="/assets/js/9.3714ce75.js">
    <link rel="stylesheet" href="/assets/css/1.styles.87b9e6fa.css"><link rel="stylesheet" href="/assets/css/2.styles.a2bd3099.css"><link rel="stylesheet" href="/assets/css/styles.613d531f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">peigenzi的博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://www.google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://www.google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>JavaScript</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/js/defineProperty.html" class="sidebar-link">Object.defineProperty()</a></li><li><a href="/blog/js/监控长任务.html" class="sidebar-link">监测长任务</a></li><li><a href="/blog/js/note-nunjucks.html" class="active sidebar-link">nunjucks 笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#文件拓展名" class="sidebar-link">文件拓展名</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#变量" class="sidebar-link">变量</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#过滤器" class="sidebar-link">过滤器</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#模板继承" class="sidebar-link">模板继承</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#super" class="sidebar-link">super</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#标签" class="sidebar-link">标签</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#关键字参数" class="sidebar-link">关键字参数</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#注释" class="sidebar-link">注释</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#空白字符控制" class="sidebar-link">空白字符控制</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#自动转义" class="sidebar-link">自动转义</a></li><li class="sidebar-sub-header"><a href="/blog/js/note-nunjucks.html#全局函数" class="sidebar-link">全局函数</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/css/css技巧.html" class="sidebar-link">css 技巧</a></li><li><a href="/blog/css/重置样式.html" class="sidebar-link">重置样式</a></li><li><a href="/blog/css/bem总结.html" class="sidebar-link">bem 总结</a></li><li><a href="/blog/css/css3动画.html" class="sidebar-link">css3 动画</a></li><li><a href="/blog/css/scss快速上手.html" class="sidebar-link">Scss 快速上手</a></li><li><a href="/blog/css/scss常用函数.html" class="sidebar-link">Scss 常用函数</a></li><li><a href="/blog/css/栅格系统.html" class="sidebar-link">栅格系统</a></li><li><a href="/blog/css/table总结.html" class="sidebar-link">table 总结</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/vue/Vue书写风格.html" class="sidebar-link">Vue 书写风格</a></li><li><a href="/blog/vue/可从外部关闭下拉菜单的Vue指令.html" class="sidebar-link">可从外部关闭下拉菜单的 Vue 指令</a></li><li><a href="/blog/vue/事件派发与广播.html" class="sidebar-link">事件派发与广播</a></li><li><a href="/blog/vue/找到任意组件实例的方法.html" class="sidebar-link">找到任意组件实例的方法</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>小程序</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/小程序/小程序登录鉴权.html" class="sidebar-link">小程序登录鉴权</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/工程化/gulp笔记.html" class="sidebar-link">gulp 笔记</a></li><li><a href="/blog/工程化/babel笔记.html" class="sidebar-link">babel 笔记</a></li><li><a href="/blog/工程化/babel-polyfill笔记.html" class="sidebar-link">babel-polyfill 笔记</a></li><li><a href="/blog/工程化/babel-preset-env常用配置.html" class="sidebar-link">babel-preset-env 常用配置</a></li><li><a href="/blog/工程化/webpack4常用配置.html" class="sidebar-link">webpack4 常用配置</a></li><li><a href="/blog/工程化/webpack4笔记.html" class="sidebar-link">webpack4 笔记</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>性能</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/performance/1使用 RAIL 模型评估性能.html" class="sidebar-link">使用 RAIL 模型评估性能</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="nunjucks-笔记"><a href="#nunjucks-笔记" aria-hidden="true" class="header-anchor">#</a> nunjucks 笔记</h1> <h2 id="文件拓展名"><a href="#文件拓展名" aria-hidden="true" class="header-anchor">#</a> 文件拓展名</h2> <p>可用任意拓展名来命名 <code>Nunjucks</code> 模板或文件，但推荐使用 <code>.njk</code></p> <h2 id="变量"><a href="#变量" aria-hidden="true" class="header-anchor">#</a> 变量</h2> <p>可以像 <code>js</code> 一样获取变量属性</p> <div class="language-njk extra-class"><pre class="language-text"><code>{{username}}
{{foo['bar']}}
</code></pre></div><p>变量的值为 <code>undefined</code> 或者 <code>null</code> 将不显示，对象也一样。</p> <h2 id="过滤器"><a href="#过滤器" aria-hidden="true" class="header-anchor">#</a> 过滤器</h2> <p>过滤器是一些可以执行变量的函数，通过管道操作符 <code>|</code> 调用，并可以接受参数。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{{foo | title}}
{{foo | join(&quot;,&quot;)}}
{{foo | replace(&quot;foo&quot;, &quot;bar&quot;) | capitalize}} //链式过滤器
</code></pre></div><p>可以自定义过滤器。</p> <h2 id="模板继承"><a href="#模板继承" aria-hidden="true" class="header-anchor">#</a> 模板继承</h2> <p>写模板时可定义 <code>block</code> ，子模板可以覆盖他，同时支持多层继承。</p> <div class="language-njk extra-class"><pre class="language-text"><code>//父 .parent.njk
{% block header %}
This is the default content
{% endblock %}

&lt;section class=&quot;left&quot;&gt;
    {% block left %}{% endblock %}
&lt;/section&gt;

&lt;section class=&quot;right&quot;&gt;
    {% block right %}
    This is more content
    {% endblock %}
&lt;/section&gt;

//子
{% extends &quot;parent.njk&quot; %}

{% block left %}
This is the left side
{% endblock %}

{% block right %}
This is the right side
{% endblock %}

//result
This is the header content

&lt;section class=&quot;left&quot;&gt;
    This is the left side
&lt;/section&gt;

&lt;section class=&quot;right&quot;&gt;
    This is the right side
&lt;/section&gt;
</code></pre></div><p>模板可以是一个变量，就可以动态指定继承的模板。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% extends parentTpl %}
</code></pre></div><p><code>extends</code> 可以接受任意表达式，只要它最终返回一个字符串或是模板所编译的对象。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% extends name + &quot;.html&quot; %}
</code></pre></div><h2 id="super"><a href="#super" aria-hidden="true" class="header-anchor">#</a> super</h2> <p>可以调用 <code>super</code> 将父级区块中的内容渲染到子区块。</p> <div class="language-njk extra-class"><pre class="language-text"><code>//如果前面的子模板是这样
{% block right %}
{{ super() }}
Right side
{% endblock %}

//result
This is more content
Right side
</code></pre></div><h2 id="标签"><a href="#标签" aria-hidden="true" class="header-anchor">#</a> 标签</h2> <p>标签是一些特殊的区块，可以对模板执行一些操作。可自定义标签</p> <h3 id="if"><a href="#if" aria-hidden="true" class="header-anchor">#</a> if</h3> <div class="language-njk extra-class"><pre class="language-text"><code>{% if flag %}
    It is true
{% endif %}


{% if A % }
    a
{% elif B %}
    b
{% else %}
    c
{% endif %}
</code></pre></div><h3 id="for"><a href="#for" aria-hidden="true" class="header-anchor">#</a> for</h3> <p>可以遍历数组和对象</p> <div class="language-njk extra-class"><pre class="language-text"><code>//js
var items = [{title: 'foo', id: 1}, {title: 'bar', id: 2}]

&lt;h1&gt;for&lt;/h1&gt;
&lt;ul&gt;
{% for item in items %}
&lt;li&gt;{{item.title}}&lt;/li&gt;
{% else %}
    &lt;li&gt;items&lt;/li&gt;
{% endfor %}&gt;
&lt;/ul&gt;


//js Nunjucks 会将数组解开，数组内的值对应到变量
var points = [[0, 1, 2], [5, 6, 7], [12, 13, 14]];

{% for x, y, z in points %}
  Point: {{ x }}, {{ y }}, {{ z }}
{% endfor %}
</code></pre></div><p>在循环中可获取一些特殊的变量</p> <ul><li><code>loop.index</code>: 当前循环数 (1 indexed)</li> <li><code>loop.index0</code>: 当前循环数 (0 indexed)</li> <li><code>loop.revindex</code>: 当前循环数，从后往前 (1 indexed)</li> <li><code>loop.revindex0</code>: 当前循环数，从后往前 (0 based)</li> <li><code>loop.first</code>: 是否第一个</li> <li><code>loop.last</code>: 是否最后一个</li> <li><code>loop.length</code>: 总数</li></ul> <h3 id="macro"><a href="#macro" aria-hidden="true" class="header-anchor">#</a> macro</h3> <p>定义可复用的内容，类似函数。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% macro field(name, value='', type='text') %}
&lt;div class=&quot;field&quot;&gt;
  &lt;input type=&quot;{{ type }}&quot; name=&quot;{{ name }}&quot;
         value=&quot;{{ value | escape }}&quot; /&gt;
&lt;/div&gt;
{% endmacro %}

//field 可当函数一样使用了
{{ field('user') }}
{{ field('pass', type='password') }}
</code></pre></div><p>还可以从其他模板 <code>import</code> 宏，可以使宏在整个项目中复用。</p> <h3 id="set"><a href="#set" aria-hidden="true" class="header-anchor">#</a> set</h3> <p>用于设置和修改变量。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{{ username }}
{% set username = &quot;joe&quot; %}
{{ username }}
</code></pre></div><p>未完</p> <h3 id="block"><a href="#block" aria-hidden="true" class="header-anchor">#</a> block</h3> <p>区块定义了模板片段并标识了一个名字，在模板中<strong>继承</strong>使用。父级模板可指定一个区块，子模板覆盖这个区块。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% block css %}
&lt;link rel=&quot;stylesheet&quot; href=&quot;app.css&quot; /&gt;
{% endblock %}

//在循环中定义块
{% for item in items %}
{% block item %}{{ item }}{% endblock %}
{% endfor %}
</code></pre></div><h3 id="include"><a href="#include" aria-hidden="true" class="header-anchor">#</a> include</h3> <p>用于引入其他模板，可在多模板之间共享一些小模板。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% include &quot;item.html&quot; %}

//循环中引入模板
{% for item in items %}
{% include &quot;item.html&quot; %}
{% endfor %}

//可以接受任意表达式，只要它最终返回一个字符串或是模板所编译成的对象
{% include name + &quot;.html&quot; as obj %}

//希望模板文件不存在时不要抛出异常
{% include &quot;missing.html&quot; ignore missing %}
</code></pre></div><p>当我们需要改变页面时，我们可以渲染这些小部分的模板，而非一整个的大的模板。</p> <h3 id="import"><a href="#import" aria-hidden="true" class="header-anchor">#</a> import</h3> <h3 id="raw"><a href="#raw" aria-hidden="true" class="header-anchor">#</a> raw</h3> <h3 id="filter"><a href="#filter" aria-hidden="true" class="header-anchor">#</a> filter</h3> <p><code>filter</code> 区块允许我们使用区块中的内容来调用过滤器。不同于使用 <code>|</code> 语法，它会将区块渲染出的内容传递给过滤器。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% filter title %}
may the force be with you
{% endfilter %}

{% filter replace(&quot;force&quot;, &quot;forth&quot;) %}
may the force be with you
{% endfilter %}
</code></pre></div><p><strong>不能在这些区块中进行任何异步操作</strong></p> <h3 id="call"><a href="#call" aria-hidden="true" class="header-anchor">#</a> call</h3> <p><code>call</code> 区块允许你使用标签之间的内容来调用一个宏。这在你需要给宏传入大量内容时是十分有用的。在宏中，你可以通过 <code>caller()</code> 来获取这些内容。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% macro add(x, y) %}
{{ caller() }}: {{ x + y }}
{% endmacro%}

{% call add(1, 2) -%}
The result is
{%- endcall %}

输出The result is: 3
</code></pre></div><h2 id="关键字参数"><a href="#关键字参数" aria-hidden="true" class="header-anchor">#</a> 关键字参数</h2> <div class="language-njk extra-class"><pre class="language-text"><code>{{ foo(1, 2, bar=3, baz=4) }}

//定义宏的时候也可以使用关键字参数，定义参数值时可设置默认值
{% macro foo(x, y, z=5, w=6) %}
{{ x }}, {{ y }}, {{ z }}, {{ w}}
{% endmacro %}

{{ foo(1, 2) }}        -&gt; 1, 2, 5, 6
{{ foo(1, 2, w=10) }}  -&gt; 1, 2, 5, 10
</code></pre></div><h2 id="注释"><a href="#注释" aria-hidden="true" class="header-anchor">#</a> 注释</h2> <div class="language-njk extra-class"><pre class="language-text"><code>{# Loop through all the users #}
{% for user in users %}...{% endfor %}
</code></pre></div><h2 id="空白字符控制"><a href="#空白字符控制" aria-hidden="true" class="header-anchor">#</a> 空白字符控制</h2> <p>模板在正常情况会将变量 (variable) 和标签区块 (tag blocks) 周围的空白字符完全输出。
可以在开始和结束区块 (start or end block tag) 添加 (-) 来去除前面和后面的空白字符。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% for i in [1,2,3,4,5] -%}
  {{ i }}
{%- endfor %}
</code></pre></div><p><code>-%}</code> 会去除标签右侧的空白字符，<code>{%-</code> 会去除标签之前的空白字符</p> <h2 id="自动转义"><a href="#自动转义" aria-hidden="true" class="header-anchor">#</a> 自动转义</h2> <p>如果在环境变量中设置了 autoescaping，所有的输出都会自动转义，但可以使用 safe 过滤器，Nunjucks 就不会转义了。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{{ foo }}           // &amp;lt;span%gt;
{{ foo | safe }}    // &lt;span&gt;
</code></pre></div><p>如果未开启 autoescaping，所有的输出都会如实输出，但可以使用 escape 过滤器来转义。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{{ foo }}           // &lt;span&gt;
{{ foo | escape }}  // &amp;lt;span&amp;gt;
</code></pre></div><h2 id="全局函数"><a href="#全局函数" aria-hidden="true" class="header-anchor">#</a> 全局函数</h2> <h3 id="range-start-stop-step"><a href="#range-start-stop-step" aria-hidden="true" class="header-anchor">#</a> range([start], stop, [step])</h3> <div class="language-njk extra-class"><pre class="language-text"><code>{% for i in range(0, 5) -%}
  {{ i }},
{%- endfor %}

0,1,2,3,4
</code></pre></div><h3 id="cycler-item1-item2-itemn"><a href="#cycler-item1-item2-itemn" aria-hidden="true" class="header-anchor">#</a> cycler(item1, item2, ...itemN)</h3> <p>可以循环调用你指定的一系列的值</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% set cls = cycler(&quot;odd&quot;, &quot;even&quot;) %}
{% for row in rows %}
  &lt;div class=&quot;{{ cls.next() }}&quot;&gt;{{ row.name }}&lt;/div&gt;
{% endfor %}

//奇数行的 class 为 &quot;odd&quot;，偶数行的 class 为 &quot;even&quot;。你可以使用current属性来获取当前项,在上面的例子中对应cls.current
</code></pre></div><h3 id="joiner-separator"><a href="#joiner-separator" aria-hidden="true" class="header-anchor">#</a> joiner([separator])</h3> <p>当合并多项的时候，希望在他们之间又分隔符 (像逗号)，但又不希望第一项也输出。joiner 将输出分割符 (默认为 &quot;,&quot;) 除了第一次调用。</p> <div class="language-njk extra-class"><pre class="language-text"><code>{% set comma = joiner() %}
{% for tag in tags -%}
  {{ comma() }} {{ tag }}
{%- endfor %}

//如果 tags 为 [&quot;food&quot;, &quot;beer&quot;, &quot;dessert&quot;], 上面将输出 food, beer, dessert
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/js/监控长任务.html" class="prev">
          监测长任务
        </a></span> <span class="next"><a href="/blog/css/css技巧.html">
          css 技巧
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/15.9a281c71.js" defer></script><script src="/assets/js/app.613d531f.js" defer></script>
  </body>
</html>
